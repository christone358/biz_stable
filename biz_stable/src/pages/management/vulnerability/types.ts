// 脆弱性风险等级枚举
export enum VulnerabilityLevel {
  HIGH = 'high',        // 高危
  MEDIUM = 'medium',    // 中危
  LOW = 'low',          // 低危
  INFO = 'info'         // 信息
}

// 脆弱性状态枚举
export enum VulnerabilityStatus {
  PENDING = 'pending',           // 待处理
  PROCESSING = 'processing',     // 处理中
  RESOLVED = 'resolved',         // 已解决
  OVERDUE = 'overdue'           // 已超期
}

// 维度类型枚举
export enum DimensionType {
  BUSINESS_SYSTEM = 'business-system',     // 业务系统
  DEPARTMENT = 'department',               // 归属单位
  VULNERABILITY_TYPE = 'vulnerability-type' // 脆弱性类型
}

// 脆弱性记录接口
export interface VulnerabilityRecord {
  id: string                          // 脆弱性ID
  name: string                        // 脆弱性名称
  cveNumber: string                   // CVE编号
  level: VulnerabilityLevel          // 风险等级
  cvssScore: number                  // CVSS评分
  businessSystem: string             // 业务系统
  assetName: string                  // 资产名称
  ipAddress: string                  // IP地址
  discoveredTime: string             // 发现时间
  status: VulnerabilityStatus        // 状态
  assignee: string | null            // 处置责任人
  department: string                 // 责任单位
  description: string                // 漏洞描述
  affectedScope: string              // 影响范围
  fixSuggestion: string              // 修复建议
  processingRecords: ProcessingRecord[] // 处理记录
}

// 处理记录接口
export interface ProcessingRecord {
  id: string
  timestamp: string
  action: string
  operator: string
}

// KPI指标接口
export interface VulnerabilityMetrics {
  total: number                      // 总脆弱性数量
  totalTrend: string                 // 总量趋势
  pending: number                    // 待处置脆弱性
  pendingTrend: string              // 待处置趋势
  highRisk: number                  // 高危脆弱性
  highRiskTrend: string             // 高危趋势
  unconfirmed: number               // 未确认资产脆弱性
  unconfirmedTrend: string          // 未确认趋势
}

// 业务系统脆弱性统计接口
export interface SystemVulnerabilityStat {
  id: string
  name: string                      // 业务系统名称
  totalCount: number                // 脆弱性数量
  highRiskCount: number             // 高危数量
  riskTrend: string                 // 风险趋势（+12%, -5%等）
  riskTrendUp: boolean              // 趋势方向
  riskLevel: VulnerabilityLevel     // 风险等级
}

// 部门处置效率统计接口
export interface DepartmentEfficiencyStat {
  id: string
  name: string                      // 责任单位名称
  totalTasks: number                // 总任务数
  resolvedTasks: number             // 已处置数
  fixRate: number                   // 修复率（百分比）
  efficiencyScore: number           // 效率分（0-100）
}

// 趋势数据接口
export interface TrendData {
  date: string
  hostVulnerability: number         // 主机漏洞
  webVulnerability: number          // Web漏洞
  configDefect: number              // 配置缺陷
  weakPassword: number              // 弱口令
}

// 风险分布数据接口
export interface RiskDistribution {
  level: VulnerabilityLevel
  count: number
}

// 树节点接口
export interface TreeNode {
  id: string
  name: string
  count: number
  checked: boolean
}

// 未确认资产脆弱性接口
export interface UnconfirmedAssetVulnerability {
  id: string
  assetName: string                 // 资产名称
  vulnerabilityType: string         // 脆弱性类型
  riskLevel: VulnerabilityLevel     // 风险等级
  discoveredTime: string            // 发现时间
}

// 派发任务表单接口
export interface AssignTaskForm {
  department: string                // 责任单位
  assignee: string                  // 处理人
  priority: 'high' | 'medium' | 'low' // 优先级
  deadline: string                  // 要求完成时间
  instructions: string              // 处理说明
}

// 分页配置接口
export interface PaginationConfig {
  current: number
  pageSize: number
  total: number
}

// 筛选条件接口
export interface FilterConditions {
  keyword: string                   // 搜索关键字
  level: VulnerabilityLevel | 'all' // 风险等级
  status: VulnerabilityStatus | 'all' // 状态
  businessSystem: string | 'all'    // 业务系统
  dimension: DimensionType          // 当前维度
  selectedTreeNode: string | null   // 选中的树节点ID
}
