# 资产运营管理页面 - 设计文档

## 版本信息
- **文档版本**: v1.0
- **创建日期**: 2025-10-14
- **最后更新**: 2025-10-14
- **页面路径**: `/management/asset-operations`

## 功能概述
资产运营管理页面是业务保障管理系统的核心功能模块之一，主要用于管理和处置未纳管资产。该页面提供对无主资产、未知资产、不合规资产的统一管理视图，帮助管理者了解资产运营情况，并支持将未纳管资产指派至相应部门进行管理。

## 设计目标
1. **全局视图**: 提供资产类型统计的全局视图，快速了解各类资产的纳管状态
2. **实时动态**: 展示部门资产纳管的实时动态，掌握各部门的资产管理活动
3. **高效管理**: 支持批量操作和筛选，提高未纳管资产的处理效率
4. **流程闭环**: 提供从发现到指派的完整资产管理流程

## 页面布局

### 整体结构
```
+----------------------------------------------------------+
|  面包屑导航                                                |
+----------------------------------------------------------+
|                                                          |
|  +---------------------+  +---------------------------+  |
|  |                     |  |                           |  |
|  |  资产类型统计卡片    |  |  部门资产纳管动态          |  |
|  |  (8张卡片)          |  |  (动态列表)                |  |
|  |                     |  |                           |  |
|  +---------------------+  +---------------------------+  |
|                                                          |
|  +------------------------------------------------------+|
|  |                                                      ||
|  |  未纳管资产列表表格                                    ||
|  |  - 筛选工具栏                                         ||
|  |  - 数据表格                                           ||
|  |  - 分页控件                                           ||
|  |                                                      ||
|  +------------------------------------------------------+|
|                                                          |
+----------------------------------------------------------+
```

### 三栏布局说明
1. **顶部左侧（60%）**: 资产类型统计卡片
   - 采用响应式网格布局（4列）
   - 每张卡片展示一种资产类型的统计信息
   - 支持点击卡片进行筛选

2. **顶部右侧（40%）**: 部门资产纳管动态
   - 垂直滚动列表
   - 显示最近的纳管活动
   - 支持点击查看部门详情

3. **底部（100%）**: 未纳管资产列表
   - 筛选工具栏（搜索、类型筛选、属性筛选）
   - 数据表格（支持多选、排序）
   - 批量操作按钮
   - 分页控件

## 核心组件

### 1. AssetOverview（资产类型统计卡片）

**功能描述**:
- 展示8种资产类型的统计信息
- 每张卡片显示：总数、已纳管数、未纳管数、无主数、未知数、不合规数
- 支持点击卡片进行筛选

**视觉设计**:
```
+------------------------+
|  [图标] 服务器          |
|                        |
|  总数          156     |
|                        |
|  ✓ 已纳管: 133         |
|  ✗ 未纳管: 23          |
|                        |
|  无主:12 未知:8 不合规:3|
+------------------------+
```

**交互设计**:
- 悬停效果：边框高亮 + 轻微上移
- 选中效果：蓝色边框 + 浅蓝背景
- 点击卡片：触发表格筛选

**技术实现**:
- 组件: `AssetOverview.tsx`
- 样式: `AssetOverview.css`
- 状态: 支持单选模式（`selectedType`）
- 事件: `onTypeSelect(type: AssetType | 'all')`

### 2. DepartmentDynamics（部门资产纳管动态）

**功能描述**:
- 展示部门最近的资产纳管活动
- 支持4种动态类型：指派、认领、导入、忽略
- 点击部门名称查看该部门的资产列表

**视觉设计**:
```
+-----------------------------------+
| 部门资产纳管动态          实时更新  |
+-----------------------------------+
| [指派] 5个资产                     |
| 指派5台服务器至信息技术部进行管理     |
| 部门: 信息技术部 | 操作人: 管理员   |
| 时间: 2小时前                      |
+-----------------------------------+
```

**交互设计**:
- 列表项悬停：背景色变化
- 点击部门链接：打开部门资产列表模态框
- 点击右侧箭头：同样打开部门资产列表

**技术实现**:
- 组件: `DepartmentDynamics.tsx`
- 样式: `DepartmentDynamics.css`
- 时间显示: dayjs + relativeTime插件
- 事件: `onDepartmentClick(departmentId, departmentName)`

### 3. UnmanagedAssetTable（未纳管资产表格）

**功能描述**:
- 展示所有未纳管资产的详细信息
- 支持多维度筛选：资产类型、资产属性、关键词搜索
- 支持批量操作：批量指派、批量忽略
- 支持单个资产操作：查看详情、指派

**表格列定义**:
| 列名 | 宽度 | 固定 | 说明 |
|------|------|------|------|
| 资产名称 | 180px | 左固定 | 支持Tooltip |
| 资产类型 | 120px | - | Tag标签 |
| 资产属性 | 120px | - | 颜色编码Tag |
| IP地址 | 140px | - | - |
| 物理位置 | 180px | - | 支持省略 |
| 发现时间 | 160px | - | - |
| 发现来源 | 120px | - | - |
| 描述 | 200px | - | 支持Tooltip |
| 操作 | 160px | 右固定 | 详情、指派按钮 |

**筛选工具栏设计**:
```
[搜索框: 资产名称、IP]  [资产类型▼]  [资产属性▼]     [批量指派(2)] [批量忽略]
```

**交互设计**:
- 行选择：复选框多选
- 搜索：实时搜索或回车搜索
- 筛选：立即生效
- 批量按钮：未选中时禁用，选中后显示数量

**技术实现**:
- 组件: `UnmanagedAssetTable.tsx`
- 样式: `UnmanagedAssetTable.css`
- 分页: 前端分页（10/20/50/100）
- 事件:
  - `onViewDetail(asset)`
  - `onAssign(assetIds[])`
  - `onIgnore(assetIds[])`
  - `onSearch(keyword)`
  - `onTypeFilter(type)`
  - `onAttributeFilter(attribute)`

### 4. AssetDetailModal（资产详情模态框）

**功能描述**:
- 展示单个未纳管资产的完整详细信息
- 使用Ant Design的Descriptions组件布局

**信息展示**:
```
资产ID:         ASSET-UNM-001
资产名称:       APP-SERVER-15
资产类型:       [服务器]
资产属性:       [无主资产]
IP地址:         192.168.10.15
资产状态:       [未纳管]
物理位置:       数据中心A区机柜A-05
发现时间:       2023-07-10 09:30:00
发现来源:       [网络扫描]
操作系统:       CentOS 7.9
版本信息:       -
厂商:           Dell
资产描述:       CentOS 7.9服务器，疑似遗留测试环境
```

**技术实现**:
- 组件: `AssetDetailModal.tsx`
- 宽度: 720px
- 布局: 2列Descriptions

### 5. DepartmentAssetModal（部门资产列表模态框）

**功能描述**:
- 展示指定部门已纳管的资产列表
- 提供部门资产的概览视图

**表格列**:
- 资产名称
- 资产类型
- IP地址
- 纳管时间
- 责任人
- 状态

**技术实现**:
- 组件: `DepartmentAssetModal.tsx`
- 宽度: 1000px
- 分页: 每页10条

### 6. AssignModal（指派部门模态框）

**功能描述**:
- 将选中的未纳管资产指派到指定部门
- 收集指派所需的必要信息

**表单字段**:
```
即将指派 3 个资产

目标部门 *:    [下拉选择]
责任人 *:      [文本输入]
联系方式:      [文本输入，手机号验证]
备注:         [多行文本，最多200字]
```

**表单验证**:
- 目标部门：必填
- 责任人：必填，最多50字符
- 联系方式：选填，手机号格式验证
- 备注：选填，最多200字符

**技术实现**:
- 组件: `AssignModal.tsx`
- 宽度: 600px
- 表单: Ant Design Form
- 提交: 异步提交 + loading状态

## 数据流设计

### 状态管理
```typescript
interface PageState {
  // 数据
  assetTypeStats: AssetTypeStats[]          // 资产类型统计
  unmanagedAssets: UnmanagedAsset[]         // 未纳管资产
  departmentDynamics: DepartmentDynamic[]   // 纳管动态
  departments: Department[]                 // 部门列表

  // 筛选条件
  filterConfig: FilterConfig                // 筛选配置

  // 分页
  pagination: PaginationConfig              // 分页配置

  // 加载状态
  loading: boolean

  // 模态框状态
  assetDetailModal: { visible, asset }
  departmentAssetModal: { visible, departmentId, departmentName, assets }
  assignModal: { visible, assetIds }
}
```

### 数据流转
1. **初始化**:
   - 组件挂载 → 调用`loadData()` → 生成Mock数据 → 更新状态

2. **筛选流程**:
   - 点击卡片/下拉选择 → 更新`filterConfig` → 触发`useMemo`重新计算 → 更新表格数据

3. **分页流程**:
   - 点击分页 → 更新`pagination` → 触发`useMemo`重新计算 → 更新表格数据

4. **指派流程**:
   - 选中资产 → 点击指派 → 打开指派模态框 → 填写表单 → 提交 → 成功提示 → 重新加载数据

## 响应式设计

### 断点策略
- **xs (<576px)**: 单列布局
- **sm (≥576px)**: 双列布局
- **md (≥768px)**: 双列布局
- **lg (≥992px)**: 三栏布局生效
- **xl (≥1200px)**: 四列卡片

### 移动端适配
1. **顶部两栏**:
   - lg及以上: 左60%、右40%
   - lg以下: 上下堆叠，各100%

2. **资产卡片**:
   - xl: 6列（4张/行）
   - lg: 8列（3张/行）
   - md: 12列（2张/行）
   - sm: 24列（1张/行）

3. **表格**:
   - 启用横向滚动
   - 固定首列和操作列

4. **筛选工具栏**:
   - lg以下: 垂直堆叠

## 色彩语义

### 资产属性颜色
- **无主资产**: orange（橙色）
- **未知资产**: red（红色）
- **不合规资产**: volcano（火山红）
- **正常资产**: default（灰色）

### 动态类型颜色
- **指派**: blue（蓝色）
- **认领**: green（绿色）
- **导入**: purple（紫色）
- **忽略**: default（灰色）

### 状态颜色
- **已纳管**: green（成功绿）
- **未纳管**: error（错误红）
- **待确认**: warning（警告橙）
- **已忽略**: default（灰色）

## 用户交互流程

### 主要用户场景

#### 场景1: 查看资产概览
```
用户进入页面
  → 查看资产类型统计卡片（8种类型的总览）
  → 查看部门纳管动态（了解最近活动）
  → 浏览未纳管资产列表
```

#### 场景2: 筛选特定类型资产
```
用户点击"服务器"卡片
  → 卡片显示选中状态
  → 表格自动筛选显示服务器类型的未纳管资产
  → 用户可进一步使用搜索框搜索
```

#### 场景3: 单个资产指派
```
用户在表格中找到目标资产
  → 点击"指派"按钮
  → 打开指派模态框
  → 选择目标部门、填写责任人和联系方式
  → 点击"确认指派"
  → 显示成功提示
  → 表格数据自动刷新
```

#### 场景4: 批量资产指派
```
用户勾选多个资产（通过复选框）
  → 点击"批量指派"按钮（显示选中数量）
  → 打开指派模态框（显示即将指派的资产数量）
  → 填写表单
  → 提交
  → 显示成功提示
  → 表格数据自动刷新
```

#### 场景5: 查看部门资产详情
```
用户在"部门纳管动态"中点击部门名称
  → 打开部门资产列表模态框
  → 查看该部门已纳管的所有资产
  → 关闭模态框
```

## 技术实现细节

### 目录结构
```
src/pages/management/asset-operations/
├── index.tsx                        # 主页面组件
├── index.css                        # 主页面样式
├── types.ts                         # TypeScript类型定义
└── components/
    ├── AssetOverview.tsx           # 资产类型统计卡片
    ├── AssetOverview.css           # 卡片样式
    ├── DepartmentDynamics.tsx      # 部门纳管动态
    ├── DepartmentDynamics.css      # 动态样式
    ├── UnmanagedAssetTable.tsx     # 未纳管资产表格
    ├── UnmanagedAssetTable.css     # 表格样式
    ├── AssetDetailModal.tsx        # 资产详情模态框
    ├── DepartmentAssetModal.tsx    # 部门资产列表模态框
    └── AssignModal.tsx             # 指派部门模态框
```

### Mock数据文件
```
src/mock/asset-operations-data.ts
├── generateUnmanagedAssets()        # 生成未纳管资产数据
├── generateAssetTypeStats()         # 生成资产类型统计数据
├── generateDepartmentDynamics()     # 生成部门纳管动态数据
├── generateDepartments()            # 生成部门列表数据
├── generateDepartmentAssets()       # 生成部门资产数据
├── assetTypeLabels                  # 资产类型中文映射
├── assetAttributeLabels             # 资产属性中文映射
├── assetStatusLabels                # 资产状态中文映射
└── dynamicTypeLabels                # 动态类型中文映射
```

### 核心依赖
- **React 18**: 前端框架
- **TypeScript**: 类型安全
- **Ant Design 5.x**: UI组件库
- **dayjs**: 时间处理（相对时间显示）

### 性能优化
1. **useMemo**: 筛选和分页计算缓存
2. **懒加载**: 模态框按需渲染（destroyOnClose）
3. **虚拟滚动**: 大数据量时可考虑表格虚拟滚动
4. **防抖**: 搜索输入防抖（如需实时搜索）

## 可访问性

### 键盘导航
- 卡片: 支持Tab导航和Enter选择
- 表格: 支持键盘导航
- 模态框: 支持ESC关闭

### 语义化HTML
- 使用适当的ARIA标签
- 图标按钮提供aria-label

### 对比度
- 遵循WCAG 2.1 AA标准
- 文本对比度 ≥ 4.5:1

## 测试要点

### 功能测试
- [ ] 页面初始化数据加载
- [ ] 资产类型卡片点击筛选
- [ ] 表格筛选器（类型、属性、搜索）
- [ ] 表格分页切换
- [ ] 表格行选择（单选、多选、全选）
- [ ] 查看资产详情
- [ ] 单个资产指派
- [ ] 批量资产指派
- [ ] 批量忽略资产
- [ ] 查看部门资产列表
- [ ] 表单验证（指派模态框）

### 响应式测试
- [ ] 移动端（<768px）布局正常
- [ ] 平板端（768px-992px）布局正常
- [ ] 桌面端（>992px）布局正常
- [ ] 各断点卡片数量正确

### 边界测试
- [ ] 空数据状态展示
- [ ] 大数据量（>1000条）性能
- [ ] 长文本截断和Tooltip
- [ ] 表单验证边界值

## 未来优化方向

1. **数据导出**: 支持导出未纳管资产列表为Excel
2. **高级筛选**: 支持多条件组合筛选
3. **批量导入**: 支持批量导入资产信息
4. **历史记录**: 记录资产指派历史
5. **通知提醒**: 新发现未纳管资产时通知
6. **统计图表**: 添加趋势图表展示
7. **自动识别**: AI辅助资产类型识别

## 更新日志

### v1.0 (2025-10-14)
- 初始版本发布
- 实现资产类型统计卡片
- 实现部门纳管动态列表
- 实现未纳管资产表格
- 实现三个模态框（详情、部门资产、指派）
- 集成到主应用路由
