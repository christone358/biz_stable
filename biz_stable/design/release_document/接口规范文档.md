# ä¸šåŠ¡ç¨³å®šæ€§ç›‘æ§ç³»ç»Ÿ - æ¥å£è§„èŒƒæ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯
- ç‰ˆæœ¬ï¼šv2.1.0
- åˆ›å»ºæ—¥æœŸï¼š2025-09-28
- æ›´æ–°æ—¥æœŸï¼š2025-09-28
- æ–‡æ¡£çŠ¶æ€ï¼šæœ€æ–°
- æ¥å£åè®®ï¼šRESTful API / HTTP/HTTPS

## ğŸ“‹ ç›®å½•
1. [æ¥å£æ¦‚è¿°](#æ¥å£æ¦‚è¿°)
2. [é€šç”¨è§„èŒƒ](#é€šç”¨è§„èŒƒ)
3. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
4. [ç»„ç»‡æ¶æ„æ¥å£](#ç»„ç»‡æ¶æ„æ¥å£)
5. [ä¸šåŠ¡ç³»ç»Ÿæ¥å£](#ä¸šåŠ¡ç³»ç»Ÿæ¥å£)
6. [èµ„äº§ç®¡ç†æ¥å£](#èµ„äº§ç®¡ç†æ¥å£)
7. [å‘Šè­¦ç›‘æ§æ¥å£](#å‘Šè­¦ç›‘æ§æ¥å£)
8. [æŒ‡æ ‡ç»Ÿè®¡æ¥å£](#æŒ‡æ ‡ç»Ÿè®¡æ¥å£)
9. [WebSocketå®æ—¶æ¥å£](#websocketå®æ—¶æ¥å£)
10. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)

## æ¥å£æ¦‚è¿°

### å½“å‰çŠ¶æ€
- **Mockæ¨¡å¼**ï¼šå½“å‰ç³»ç»Ÿä½¿ç”¨å‰ç«¯Mockæ•°æ®ï¼Œæ‰€æœ‰æ¥å£å‡ä¸ºæ¨¡æ‹Ÿå®ç°
- **çœŸå®æ¥å£**ï¼šæœ¬æ–‡æ¡£æè¿°äº†ç³»ç»Ÿå¯¹æ¥çœŸå®åç«¯æ—¶çš„æ¥å£è§„èŒƒ
- **ç‰ˆæœ¬ç®¡ç†**ï¼šé‡‡ç”¨URLç‰ˆæœ¬æ§åˆ¶ï¼Œå¦‚`/api/v1/`

### åŸºç¡€ä¿¡æ¯
- **Base URL**: `https://api.example.com/api/v1`
- **åè®®**: HTTPS
- **è®¤è¯æ–¹å¼**: Bearer Token / API Key
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8

## é€šç”¨è§„èŒƒ

### HTTPçŠ¶æ€ç 
```
200 OK              - è¯·æ±‚æˆåŠŸ
201 Created         - èµ„æºåˆ›å»ºæˆåŠŸ
204 No Content      - åˆ é™¤æˆåŠŸ
400 Bad Request     - è¯·æ±‚å‚æ•°é”™è¯¯
401 Unauthorized    - æœªæˆæƒè®¿é—®
403 Forbidden       - æƒé™ä¸è¶³
404 Not Found       - èµ„æºä¸å­˜åœ¨
422 Unprocessable   - æ•°æ®éªŒè¯å¤±è´¥
500 Internal Error  - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
502 Bad Gateway     - ç½‘å…³é”™è¯¯
503 Service Unavailable - æœåŠ¡ä¸å¯ç”¨
```

### ç»Ÿä¸€å“åº”æ ¼å¼
```typescript
interface ApiResponse<T> {
  code: number          // ä¸šåŠ¡çŠ¶æ€ç 
  message: string       // å“åº”æ¶ˆæ¯
  data: T              // å“åº”æ•°æ®
  timestamp: string    // å“åº”æ—¶é—´æˆ³
  requestId?: string   // è¯·æ±‚IDï¼ˆç”¨äºè¿½è¸ªï¼‰
}

// æˆåŠŸå“åº”ç¤ºä¾‹
{
  "code": 200,
  "message": "success",
  "data": { /* å®é™…æ•°æ® */ },
  "timestamp": "2025-09-28T10:00:00Z",
  "requestId": "req_12345"
}

// é”™è¯¯å“åº”ç¤ºä¾‹
{
  "code": 400,
  "message": "å‚æ•°éªŒè¯å¤±è´¥",
  "data": null,
  "timestamp": "2025-09-28T10:00:00Z",
  "requestId": "req_12345",
  "errors": [
    {
      "field": "organizationId",
      "message": "ç»„ç»‡IDä¸èƒ½ä¸ºç©º"
    }
  ]
}
```

### åˆ†é¡µè§„èŒƒ
```typescript
interface PaginationRequest {
  page: number        // é¡µç ï¼Œä»1å¼€å§‹
  pageSize: number    // æ¯é¡µå¤§å°ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100
  sortBy?: string     // æ’åºå­—æ®µ
  sortOrder?: 'asc' | 'desc'  // æ’åºæ–¹å‘
}

interface PaginationResponse<T> {
  list: T[]           // æ•°æ®åˆ—è¡¨
  pagination: {
    page: number      // å½“å‰é¡µç 
    pageSize: number  // æ¯é¡µå¤§å°
    total: number     // æ€»è®°å½•æ•°
    totalPages: number // æ€»é¡µæ•°
    hasNext: boolean  // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
    hasPrev: boolean  // æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
  }
}
```

### è¯·æ±‚å¤´è§„èŒƒ
```
Content-Type: application/json
Authorization: Bearer {token}
X-API-Version: v1
X-Request-ID: {unique_id}
Accept: application/json
User-Agent: BizStable-Frontend/2.1.0
```

## æ•°æ®æ¨¡å‹

### ç»„ç»‡èŠ‚ç‚¹æ¨¡å‹
```typescript
interface OrganizationNode {
  id: string                    // èŠ‚ç‚¹ID
  name: string                  // èŠ‚ç‚¹åç§°
  type: 'root' | 'department' | 'system' | 'asset'  // èŠ‚ç‚¹ç±»å‹
  parentId?: string             // çˆ¶èŠ‚ç‚¹ID
  level: number                 // å±‚çº§æ·±åº¦
  systemCount: number           // ç³»ç»Ÿæ•°é‡
  assetCount: number            // èµ„äº§æ•°é‡
  healthStatus: HealthStatus    // å¥åº·çŠ¶æ€
  children?: OrganizationNode[] // å­èŠ‚ç‚¹åˆ—è¡¨
  isExpanded?: boolean          // æ˜¯å¦å±•å¼€
  metadata?: Record<string, any> // æ‰©å±•å…ƒæ•°æ®
  createdAt: string            // åˆ›å»ºæ—¶é—´
  updatedAt: string            // æ›´æ–°æ—¶é—´
}
```

### ä¸šåŠ¡ç³»ç»Ÿæ¨¡å‹
```typescript
interface BusinessSystem {
  id: string                   // ç³»ç»ŸID
  name: string                 // ç³»ç»Ÿåç§°
  displayName?: string         // æ˜¾ç¤ºåç§°
  description?: string         // ç³»ç»Ÿæè¿°
  department: string           // æ‰€å±éƒ¨é—¨
  departmentId: string         // éƒ¨é—¨ID
  importance: ImportanceLevel  // é‡è¦æ€§ç­‰çº§
  healthStatus: HealthStatus   // å¥åº·çŠ¶æ€
  assetCount: number          // èµ„äº§æ•°é‡
  vulnerabilityCount: number   // æ¼æ´æ•°é‡
  alertCount: number          // å‘Šè­¦æ•°é‡
  errorRate: number           // é”™è¯¯ç‡(%)
  responseTime: number        // å“åº”æ—¶é—´(ms)
  availability: number        // å¯ç”¨æ€§(%)
  owner?: string              // è´£ä»»äºº
  contact?: string            // è”ç³»æ–¹å¼
  lastCheck?: string          // æœ€åæ£€æŸ¥æ—¶é—´
  createdAt: string           // åˆ›å»ºæ—¶é—´
  updatedAt: string           // æ›´æ–°æ—¶é—´
}
```

### èµ„äº§æ¨¡å‹
```typescript
interface Asset {
  id: string                  // èµ„äº§ID
  name: string                // èµ„äº§åç§°
  type: string                // èµ„äº§ç±»å‹
  healthStatus: HealthStatus  // å¥åº·çŠ¶æ€
  importance: ImportanceLevel // é‡è¦æ€§ç­‰çº§
  systemId: string           // æ‰€å±ç³»ç»ŸID
  systemName: string         // ç³»ç»Ÿåç§°
  departmentId: string       // éƒ¨é—¨ID
  department: string         // éƒ¨é—¨åç§°
  ipAddress?: string         // IPåœ°å€
  hostname?: string          // ä¸»æœºå
  location?: string          // ç‰©ç†ä½ç½®
  description?: string       // èµ„äº§æè¿°
  errorRate: number          // é”™è¯¯ç‡(%)
  responseTime: number       // å“åº”æ—¶é—´(ms)
  availability: number       // å¯ç”¨æ€§(%)
  alertCount: number         // å‘Šè­¦æ•°é‡
  vulnerabilityCount: number // æ¼æ´æ•°é‡
  lastCheck?: string         // æœ€åæ£€æŸ¥æ—¶é—´
  createdAt: string          // åˆ›å»ºæ—¶é—´
  updatedAt: string          // æ›´æ–°æ—¶é—´
}
```

### å‘Šè­¦æ¨¡å‹
```typescript
interface Alert {
  id: string                 // å‘Šè­¦ID
  type: 'RUNTIME' | 'VULNERABILITY' | 'SECURITY'  // å‘Šè­¦ç±»å‹
  level: AlertLevel          // å‘Šè­¦çº§åˆ«
  title: string              // å‘Šè­¦æ ‡é¢˜
  description: string        // å‘Šè­¦æè¿°
  systemId: string          // å…³è”ç³»ç»ŸID
  systemName: string        // ç³»ç»Ÿåç§°
  assetId?: string          // å…³è”èµ„äº§ID
  assetName?: string        // èµ„äº§åç§°
  department: string        // æ‰€å±éƒ¨é—¨
  status: 'OPEN' | 'ACKNOWLEDGED' | 'RESOLVED' | 'CLOSED'  // å‘Šè­¦çŠ¶æ€
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW'  // ä¸¥é‡ç¨‹åº¦
  timestamp: string         // å‘Šè­¦æ—¶é—´
  acknowledgedAt?: string   // ç¡®è®¤æ—¶é—´
  resolvedAt?: string       // è§£å†³æ—¶é—´
  assignee?: string         // å¤„ç†äºº
  tags?: string[]           // æ ‡ç­¾
  metadata?: Record<string, any>  // æ‰©å±•ä¿¡æ¯
}
```

## ç»„ç»‡æ¶æ„æ¥å£

### è·å–ç»„ç»‡æ¶æ„æ ‘
```http
GET /api/v1/organizations/tree
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetOrganizationTreeParams {
  includeAssets?: boolean    // æ˜¯å¦åŒ…å«èµ„äº§èŠ‚ç‚¹ï¼Œé»˜è®¤false
  maxDepth?: number         // æœ€å¤§æ·±åº¦ï¼Œé»˜è®¤ä¸é™åˆ¶
  healthStatusFilter?: HealthStatus[]  // å¥åº·çŠ¶æ€è¿‡æ»¤
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": "org_root",
      "name": "XXå¸‚å¤§æ•°æ®ä¸­å¿ƒ",
      "type": "root",
      "level": 0,
      "systemCount": 25,
      "assetCount": 156,
      "healthStatus": "WARNING",
      "children": [
        {
          "id": "dept_001",
          "name": "å¸‚å…¬å®‰å±€",
          "type": "department",
          "parentId": "org_root",
          "level": 1,
          "systemCount": 5,
          "assetCount": 32,
          "healthStatus": "HEALTHY",
          "children": []
        }
      ],
      "createdAt": "2025-01-01T00:00:00Z",
      "updatedAt": "2025-09-28T10:00:00Z"
    }
  ],
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### è·å–å•ä¸ªèŠ‚ç‚¹è¯¦æƒ…
```http
GET /api/v1/organizations/{id}
```

**è·¯å¾„å‚æ•°**:
- `id`: ç»„ç»‡èŠ‚ç‚¹ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "dept_001",
    "name": "å¸‚å…¬å®‰å±€",
    "type": "department",
    "parentId": "org_root",
    "level": 1,
    "systemCount": 5,
    "assetCount": 32,
    "healthStatus": "HEALTHY",
    "metadata": {
      "contact": "å¼ ä¸‰",
      "phone": "138****1234",
      "address": "å¸‚æ”¿åºœå¤§æ¥¼3æ¥¼"
    },
    "createdAt": "2025-01-01T00:00:00Z",
    "updatedAt": "2025-09-28T10:00:00Z"
  },
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### è·å–å­èŠ‚ç‚¹åˆ—è¡¨
```http
GET /api/v1/organizations/{id}/children
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetChildrenParams {
  type?: 'department' | 'system' | 'asset'  // å­èŠ‚ç‚¹ç±»å‹è¿‡æ»¤
  healthStatus?: HealthStatus[]              // å¥åº·çŠ¶æ€è¿‡æ»¤
  page?: number                             // é¡µç 
  pageSize?: number                         // æ¯é¡µå¤§å°
}
```

## ä¸šåŠ¡ç³»ç»Ÿæ¥å£

### è·å–ä¸šåŠ¡ç³»ç»Ÿåˆ—è¡¨
```http
GET /api/v1/systems
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetSystemsParams {
  departmentId?: string      // éƒ¨é—¨IDè¿‡æ»¤
  healthStatus?: HealthStatus[]  // å¥åº·çŠ¶æ€è¿‡æ»¤
  importance?: ImportanceLevel[] // é‡è¦æ€§è¿‡æ»¤
  search?: string           // å…³é”®è¯æœç´¢
  sortBy?: string          // æ’åºå­—æ®µ
  sortOrder?: 'asc' | 'desc'  // æ’åºæ–¹å‘
  page?: number            // é¡µç 
  pageSize?: number        // æ¯é¡µå¤§å°
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "sys_001",
        "name": "å…¬å®‰æ‰§æ³•ç³»ç»Ÿ",
        "displayName": "å…¬å®‰æ‰§æ³•ç®¡ç†å¹³å°",
        "description": "å…¬å®‰éƒ¨é—¨æ—¥å¸¸æ‰§æ³•ç®¡ç†ç³»ç»Ÿ",
        "department": "å¸‚å…¬å®‰å±€",
        "departmentId": "dept_001",
        "importance": "HIGH",
        "healthStatus": "HEALTHY",
        "assetCount": 15,
        "vulnerabilityCount": 2,
        "alertCount": 0,
        "errorRate": 0.5,
        "responseTime": 120,
        "availability": 99.8,
        "owner": "æå››",
        "contact": "li.si@gov.cn",
        "lastCheck": "2025-09-28T09:30:00Z",
        "createdAt": "2025-01-01T00:00:00Z",
        "updatedAt": "2025-09-28T09:30:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 20,
      "total": 25,
      "totalPages": 2,
      "hasNext": true,
      "hasPrev": false
    }
  },
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### è·å–ç³»ç»Ÿè¯¦æƒ…
```http
GET /api/v1/systems/{id}
```

### è·å–ç³»ç»Ÿèµ„äº§åˆ—è¡¨
```http
GET /api/v1/systems/{id}/assets
```

### è·å–ç³»ç»Ÿå‘Šè­¦åˆ—è¡¨
```http
GET /api/v1/systems/{id}/alerts
```

## èµ„äº§ç®¡ç†æ¥å£

### è·å–èµ„äº§åˆ—è¡¨
```http
GET /api/v1/assets
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetAssetsParams {
  systemId?: string         // ç³»ç»ŸIDè¿‡æ»¤
  departmentId?: string     // éƒ¨é—¨IDè¿‡æ»¤
  type?: string[]          // èµ„äº§ç±»å‹è¿‡æ»¤
  healthStatus?: HealthStatus[]  // å¥åº·çŠ¶æ€è¿‡æ»¤
  importance?: ImportanceLevel[] // é‡è¦æ€§è¿‡æ»¤
  hasAlerts?: boolean      // æ˜¯å¦æœ‰å‘Šè­¦
  hasVulnerabilities?: boolean  // æ˜¯å¦æœ‰æ¼æ´
  search?: string         // å…³é”®è¯æœç´¢
  page?: number           // é¡µç 
  pageSize?: number       // æ¯é¡µå¤§å°
}
```

### è·å–èµ„äº§è¯¦æƒ…
```http
GET /api/v1/assets/{id}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "asset_001",
    "name": "æœåŠ¡å™¨-01",
    "type": "æœåŠ¡å™¨",
    "healthStatus": "HEALTHY",
    "importance": "HIGH",
    "systemId": "sys_001",
    "systemName": "å…¬å®‰æ‰§æ³•ç³»ç»Ÿ",
    "departmentId": "dept_001",
    "department": "å¸‚å…¬å®‰å±€",
    "ipAddress": "192.168.1.100",
    "hostname": "app-server-01",
    "location": "æœºæˆ¿A-01",
    "description": "æ ¸å¿ƒåº”ç”¨æœåŠ¡å™¨",
    "errorRate": 0.2,
    "responseTime": 85,
    "availability": 99.9,
    "alertCount": 0,
    "vulnerabilityCount": 1,
    "lastCheck": "2025-09-28T09:45:00Z",
    "createdAt": "2025-01-01T00:00:00Z",
    "updatedAt": "2025-09-28T09:45:00Z"
  },
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### è·å–èµ„äº§æŒ‡æ ‡å†å²
```http
GET /api/v1/assets/{id}/metrics
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetAssetMetricsParams {
  startTime: string        // å¼€å§‹æ—¶é—´
  endTime: string          // ç»“æŸæ—¶é—´
  interval?: string        // é‡‡æ ·é—´éš” (5m, 1h, 1d)
  metrics?: string[]       // æŒ‡æ ‡åç§°åˆ—è¡¨
}
```

## å‘Šè­¦ç›‘æ§æ¥å£

### è·å–å‘Šè­¦åˆ—è¡¨
```http
GET /api/v1/alerts
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetAlertsParams {
  type?: ('RUNTIME' | 'VULNERABILITY' | 'SECURITY')[]  // å‘Šè­¦ç±»å‹
  level?: AlertLevel[]      // å‘Šè­¦çº§åˆ«
  status?: ('OPEN' | 'ACKNOWLEDGED' | 'RESOLVED' | 'CLOSED')[]  // å‘Šè­¦çŠ¶æ€
  severity?: ('CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW')[]  // ä¸¥é‡ç¨‹åº¦
  systemId?: string        // ç³»ç»ŸIDè¿‡æ»¤
  departmentId?: string    // éƒ¨é—¨IDè¿‡æ»¤
  assetId?: string        // èµ„äº§IDè¿‡æ»¤
  assignee?: string       // å¤„ç†äººè¿‡æ»¤
  startTime?: string      // å¼€å§‹æ—¶é—´
  endTime?: string        // ç»“æŸæ—¶é—´
  search?: string         // å…³é”®è¯æœç´¢
  page?: number           // é¡µç 
  pageSize?: number       // æ¯é¡µå¤§å°
}
```

### è·å–å‘Šè­¦è¯¦æƒ…
```http
GET /api/v1/alerts/{id}
```

### ç¡®è®¤å‘Šè­¦
```http
POST /api/v1/alerts/{id}/acknowledge
```

**è¯·æ±‚ä½“**:
```json
{
  "comment": "å·²ç¡®è®¤ï¼Œæ­£åœ¨å¤„ç†ä¸­"
}
```

### è§£å†³å‘Šè­¦
```http
POST /api/v1/alerts/{id}/resolve
```

**è¯·æ±‚ä½“**:
```json
{
  "solution": "é‡å¯æœåŠ¡å·²è§£å†³é—®é¢˜",
  "comment": "é—®é¢˜å·²ä¿®å¤"
}
```

### è·å–å‘Šè­¦ç»Ÿè®¡
```http
GET /api/v1/alerts/statistics
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetAlertStatisticsParams {
  groupBy: 'type' | 'level' | 'status' | 'department' | 'system'  // åˆ†ç»„ç»´åº¦
  startTime?: string       // å¼€å§‹æ—¶é—´
  endTime?: string         // ç»“æŸæ—¶é—´
  departmentId?: string    // éƒ¨é—¨IDè¿‡æ»¤
  systemId?: string        // ç³»ç»ŸIDè¿‡æ»¤
}
```

## æŒ‡æ ‡ç»Ÿè®¡æ¥å£

### è·å–KPIæŒ‡æ ‡
```http
GET /api/v1/metrics/kpi
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetKPIMetricsParams {
  scope?: 'global' | 'department' | 'system'  // ç»Ÿè®¡èŒƒå›´
  targetId?: string        // ç›®æ ‡IDï¼ˆéƒ¨é—¨IDæˆ–ç³»ç»ŸIDï¼‰
  timeRange?: string       // æ—¶é—´èŒƒå›´ (1h, 24h, 7d, 30d)
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "totalSystems": {
      "count": 25,
      "trend": "+2",  // ç›¸æ¯”ä¸ŠæœŸå˜åŒ–
      "trendType": "up"
    },
    "abnormalSystems": {
      "count": 3,
      "warningCount": 2,
      "criticalCount": 1,
      "rate": 12.0,
      "trend": "-1",
      "trendType": "down"
    },
    "urgentAlerts": {
      "total": 8,
      "p0Count": 1,
      "p1Count": 3,
      "latestTime": "2025-09-28T09:30:00Z",
      "trend": "+2",
      "trendType": "up"
    },
    "criticalVulnerabilities": {
      "count": 15,
      "affectedSystems": 8,
      "longestUnfixed": 7,  // å¤©æ•°
      "trend": "-3",
      "trendType": "down"
    }
  },
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### è·å–å¥åº·çŸ©é˜µæ•°æ®
```http
GET /api/v1/metrics/health-matrix
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetHealthMatrixParams {
  departmentId?: string    // éƒ¨é—¨IDè¿‡æ»¤
  systemId?: string        // ç³»ç»ŸIDè¿‡æ»¤
  includeAssets?: boolean  // æ˜¯å¦åŒ…å«èµ„äº§æ•°æ®
  groupBy?: 'department' | 'system' | 'asset'  // åˆ†ç»„ç»´åº¦
}
```

### è·å–è¶‹åŠ¿æ•°æ®
```http
GET /api/v1/metrics/trends
```

**æŸ¥è¯¢å‚æ•°**:
```typescript
interface GetTrendsParams {
  metrics: string[]        // æŒ‡æ ‡åç§°åˆ—è¡¨
  startTime: string        // å¼€å§‹æ—¶é—´
  endTime: string          // ç»“æŸæ—¶é—´
  interval: string         // æ—¶é—´é—´éš”
  scope?: string           // ç»Ÿè®¡èŒƒå›´
  targetId?: string        // ç›®æ ‡ID
}
```

## WebSocketå®æ—¶æ¥å£

### è¿æ¥åœ°å€
```
ws://api.example.com/ws/v1/realtime
```

### è®¤è¯
```javascript
// è¿æ¥æ—¶æºå¸¦token
const ws = new WebSocket('ws://api.example.com/ws/v1/realtime?token=Bearer_Token')
```

### è®¢é˜…æ¶ˆæ¯æ ¼å¼
```json
{
  "action": "subscribe",
  "topics": [
    "alerts.new",           // æ–°å‘Šè­¦
    "alerts.update",        // å‘Šè­¦çŠ¶æ€æ›´æ–°
    "systems.health",       // ç³»ç»Ÿå¥åº·çŠ¶æ€å˜åŒ–
    "assets.metrics",       // èµ„äº§æŒ‡æ ‡æ›´æ–°
    "kpi.update"           // KPIæŒ‡æ ‡æ›´æ–°
  ],
  "filters": {
    "departmentId": "dept_001",
    "systemId": "sys_001"
  }
}
```

### æ¨é€æ¶ˆæ¯æ ¼å¼
```json
{
  "topic": "alerts.new",
  "data": {
    "id": "alert_new_001",
    "type": "RUNTIME",
    "level": "P1",
    "title": "æœåŠ¡å™¨å“åº”è¶…æ—¶",
    "systemName": "å…¬å®‰æ‰§æ³•ç³»ç»Ÿ",
    "timestamp": "2025-09-28T10:00:00Z"
  },
  "timestamp": "2025-09-28T10:00:00Z"
}
```

### å¿ƒè·³æœºåˆ¶
```json
// å®¢æˆ·ç«¯å‘é€
{
  "action": "ping"
}

// æœåŠ¡ç«¯å“åº”
{
  "action": "pong",
  "timestamp": "2025-09-28T10:00:00Z"
}
```

## é”™è¯¯å¤„ç†

### é”™è¯¯ç å®šä¹‰
```typescript
enum ErrorCode {
  // é€šç”¨é”™è¯¯ (1000-1999)
  INVALID_PARAMETER = 1001,     // å‚æ•°é”™è¯¯
  MISSING_PARAMETER = 1002,     // ç¼ºå°‘å‚æ•°
  INVALID_FORMAT = 1003,        // æ ¼å¼é”™è¯¯

  // è®¤è¯é”™è¯¯ (2000-2999)
  UNAUTHORIZED = 2001,          // æœªæˆæƒ
  TOKEN_EXPIRED = 2002,         // Tokenè¿‡æœŸ
  INVALID_TOKEN = 2003,         // Tokenæ— æ•ˆ
  PERMISSION_DENIED = 2004,     // æƒé™ä¸è¶³

  // ä¸šåŠ¡é”™è¯¯ (3000-3999)
  RESOURCE_NOT_FOUND = 3001,    // èµ„æºä¸å­˜åœ¨
  RESOURCE_CONFLICT = 3002,     // èµ„æºå†²çª
  BUSINESS_RULE_VIOLATION = 3003, // ä¸šåŠ¡è§„åˆ™è¿å

  // ç³»ç»Ÿé”™è¯¯ (5000-5999)
  INTERNAL_ERROR = 5001,        // å†…éƒ¨é”™è¯¯
  DATABASE_ERROR = 5002,        // æ•°æ®åº“é”™è¯¯
  EXTERNAL_SERVICE_ERROR = 5003, // å¤–éƒ¨æœåŠ¡é”™è¯¯
  RATE_LIMIT_EXCEEDED = 5004    // è¯·æ±‚é¢‘ç‡è¶…é™
}
```

### é”™è¯¯å“åº”ç¤ºä¾‹
```json
{
  "code": 1001,
  "message": "å‚æ•°éªŒè¯å¤±è´¥",
  "data": null,
  "timestamp": "2025-09-28T10:00:00Z",
  "requestId": "req_12345",
  "errors": [
    {
      "field": "departmentId",
      "code": "REQUIRED",
      "message": "éƒ¨é—¨IDä¸èƒ½ä¸ºç©º"
    },
    {
      "field": "pageSize",
      "code": "OUT_OF_RANGE",
      "message": "æ¯é¡µå¤§å°å¿…é¡»åœ¨1-100ä¹‹é—´"
    }
  ]
}
```

### é‡è¯•ç­–ç•¥
```typescript
interface RetryConfig {
  maxRetries: number        // æœ€å¤§é‡è¯•æ¬¡æ•°
  baseDelay: number        // åŸºç¡€å»¶è¿Ÿ(ms)
  maxDelay: number         // æœ€å¤§å»¶è¿Ÿ(ms)
  backoffFactor: number    // é€€é¿å› å­
  retryableErrors: number[] // å¯é‡è¯•çš„é”™è¯¯ç 
}

// é»˜è®¤é‡è¯•é…ç½®
const defaultRetryConfig: RetryConfig = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 10000,
  backoffFactor: 2,
  retryableErrors: [5001, 5002, 5003] // ä»…ç³»ç»Ÿé”™è¯¯é‡è¯•
}
```

## æ¥å£æµ‹è¯•

### Mockæ¥å£é…ç½®
å½“å‰ç³»ç»Ÿæ”¯æŒMockæ¨¡å¼ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š

```typescript
// ç¯å¢ƒå˜é‡
VITE_ENABLE_MOCK=true
VITE_MOCK_DELAY=500  // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ

// Mocké…ç½®é¡µé¢
è®¿é—® /mock-config é¡µé¢è¿›è¡Œå¯è§†åŒ–é…ç½®
```

### æ¥å£æµ‹è¯•ç”¨ä¾‹
```typescript
// ç»„ç»‡æ¶æ„æµ‹è¯•
describe('Organization API', () => {
  test('è·å–ç»„ç»‡æ¶æ„æ ‘', async () => {
    const response = await api.get('/organizations/tree')
    expect(response.code).toBe(200)
    expect(response.data).toBeInstanceOf(Array)
  })
})

// å‘Šè­¦æ¥å£æµ‹è¯•
describe('Alert API', () => {
  test('è·å–å‘Šè­¦åˆ—è¡¨', async () => {
    const params = { type: ['RUNTIME'], status: ['OPEN'] }
    const response = await api.get('/alerts', { params })
    expect(response.data.list).toBeInstanceOf(Array)
  })
})
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£
- [åŠŸèƒ½æ›´æ–°æ–‡æ¡£](./åŠŸèƒ½æ›´æ–°æ–‡æ¡£.md)
- [æŠ€æœ¯æ¶æ„æ–‡æ¡£](./æŠ€æœ¯æ¶æ„æ–‡æ¡£.md)
- [UI-UXè®¾è®¡è§„èŒƒ](./UI-UXè®¾è®¡è§„èŒƒ.md)
- [äº§å“éœ€æ±‚æ–‡æ¡£PRD](./äº§å“éœ€æ±‚æ–‡æ¡£PRD.md)
- [å¼€å‘æŒ‡å—](../CLAUDE.md)

---

**æ¥å£ç»´æŠ¤**: è¯·åœ¨ç³»ç»Ÿæ¥å£å‘ç”Ÿå˜åŒ–æ—¶åŠæ—¶æ›´æ–°æœ¬æ–‡æ¡£ï¼Œç¡®ä¿å‰åç«¯å¼€å‘äººå‘˜ä¿¡æ¯åŒæ­¥