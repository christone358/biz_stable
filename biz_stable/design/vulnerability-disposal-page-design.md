# 脆弱性处置页面设计文档

## 文档信息
- **页面名称**: 脆弱性处置
- **所属系统**: 系统二 - 业务协同管理系统
- **页面路径**: `/collaboration/vulnerability`
- **创建时间**: 2025-10-14
- **最后更新**: 2025-10-14

## 页面概述

### 功能定位
脆弱性处置页面是面向运维和开发单位的操作界面，用于查看、处理和反馈由业务保障管理系统派发的脆弱性处置任务。该页面强调快速响应和处置记录的完整性。

### 目标用户
- 运维工程师
- 开发工程师
- 技术支持人员

### 核心功能
1. 查看派发的脆弱性任务列表
2. 按状态、等级筛选脆弱性
3. 处理脆弱性并记录处置过程
4. 查看脆弱性详细信息和修复建议
5. 上传处置证明文件

## 页面结构

### 整体布局
```
┌─────────────────────────────────────────────────────────────┐
│ 顶部统计卡片区 (MetricsCards)                                │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐                        │
│ │待处理   │ │处理中   │ │本月完成 │                        │
│ └─────────┘ └─────────┘ └─────────┘                        │
├─────────────────────────────────────────────────────────────┤
│ 筛选操作区                                                   │
│ [搜索框] [等级筛选] [状态筛选] [查询] [重置]    [导出数据] │
├─────────────────────────────────────────────────────────────┤
│ 脆弱性列表 (Table)                                          │
│ ┌───────────────────────────────────────────────────────┐  │
│ │ 名称 | 等级 | 资产 | 派发人 | 截止时间 | 状态 | 操作  │  │
│ │ ...                                                    │  │
│ └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 处理抽屉 (Drawer)
```
┌─────────────────────────────────────┐
│ 脆弱性处理                    [X]   │
├─────────────────────────────────────┤
│ 【脆弱性信息】                       │
│ - 基本信息描述                       │
│                                     │
│ 【派发信息】                         │
│ - 派发人、派发时间、截止时间         │
│                                     │
│ 【漏洞详情】                         │
│ - 漏洞描述、影响范围、修复建议       │
│                                     │
│ 【处理记录】(时间线展示)             │
│ - 历史处理记录                       │
│                                     │
│ 【处理表单】                         │
│ - 处理状态选择                       │
│ - 处理方式选择                       │
│ - 处理结果填写                       │
│ - 附件上传                          │
├─────────────────────────────────────┤
│              [取消] [提交处理结果]  │
└─────────────────────────────────────┘
```

## 组件设计

### 1. MetricsCards 组件
**文件位置**: `src/pages/collaboration/vulnerability/components/MetricsCards.tsx`

**功能说明**:
- 展示脆弱性处置的关键指标
- 显示趋势变化（上升/下降）
- 使用不同颜色区分不同状态

**数据结构**:
```typescript
interface DisposalMetrics {
  pending: number              // 待处理数量
  pendingTrend: string         // 待处理趋势
  processing: number           // 处理中数量
  processingTrend: string      // 处理中趋势
  completedThisMonth: number   // 本月完成数量
  completedTrend: string       // 完成趋势
}
```

**样式特点**:
- 卡片左侧带颜色边框标识
- hover效果：阴影加深、轻微上移
- 响应式布局：移动端垂直堆叠

### 2. DisposalDrawer 组件
**文件位置**: `src/pages/collaboration/vulnerability/components/DisposalDrawer.tsx`

**功能说明**:
- 展示脆弱性完整信息
- 提供处理表单
- 时间线展示历史处理记录
- 支持附件上传

**表单字段**:
- 处理状态：处理中/已完成
- 处理方式：版本升级/补丁安装/配置修改/临时规避/其他
- 处理结果：文本域（必填，最多500字）
- 附件上传：最多5个文件，单个文件不超过5MB

**交互特点**:
- 抽屉宽度：720px
- 底部固定操作按钮
- 表单验证：实时验证+提交验证

### 3. 主页面组件
**文件位置**: `src/pages/collaboration/vulnerability/index.tsx`

**状态管理**:
- 记录列表：从Mock数据加载
- 筛选条件：关键字、等级、状态
- 分页配置：当前页、每页数量
- 抽屉显隐：打开/关闭状态
- 选中记录：当前操作的记录

**筛选功能**:
- 关键字搜索：脆弱性名称、CVE编号、资产名称
- 等级筛选：全部/高危/中危/低危
- 状态筛选：全部/待处理/处理中/已完成

**表格列设计**:
1. 脆弱性名称（主信息+CVE编号）
2. 风险等级（Tag标签）
3. 影响资产（主信息+IP地址）
4. 发布时间
5. 派发人
6. 要求完成时间
7. 状态（Tag标签）
8. 操作按钮（处理/查看）

## 数据模型

### VulnerabilityDisposalRecord
```typescript
interface VulnerabilityDisposalRecord {
  id: string                    // 脆弱性ID
  name: string                  // 脆弱性名称
  cveNumber: string             // CVE编号
  level: VulnerabilityLevel     // 风险等级
  cvssScore: number             // CVSS评分
  assetName: string             // 资产名称
  ipAddress: string             // IP地址
  assetType: string             // 资产类型
  osVersion: string             // 操作系统/版本
  publishedTime: string         // 发布时间
  status: DisposalStatus        // 状态
  assignedBy: string | null     // 派发人
  assignedTime: string | null   // 派发时间
  deadline: string | null       // 要求完成时间
  instructions: string | null   // 处理说明
  description: string           // 漏洞描述
  affectedScope: string         // 影响范围
  fixSuggestion: string         // 修复建议
  processingRecords: ProcessingRecord[]  // 处理记录
}
```

### 枚举类型
```typescript
enum VulnerabilityLevel {
  HIGH = 'high',      // 高危 - 红色
  MEDIUM = 'medium',  // 中危 - 橙色
  LOW = 'low'         // 低危 - 绿色
}

enum DisposalStatus {
  PENDING = 'pending',        // 待处理 - 橙色
  PROCESSING = 'processing',  // 处理中 - 蓝色
  COMPLETED = 'completed'     // 已完成 - 绿色
}

enum ProcessingMethod {
  VERSION_UPGRADE = 'version_upgrade',    // 版本升级
  PATCH_INSTALL = 'patch_install',        // 补丁安装
  CONFIG_MODIFY = 'config_modify',        // 配置修改
  TEMP_WORKAROUND = 'temp_workaround',    // 临时规避
  OTHER = 'other'                         // 其他方式
}
```

## 样式设计

### 颜色方案
- 主色调：#1890FF (Ant Design Primary Blue)
- 成功色：#52C41A (绿色)
- 警告色：#FAAD14 (橙色)
- 错误色：#FF4D4F (红色)
- 文本主色：#1F1F1F
- 文本次色：#8C8C8C
- 背景色：#F5F5F5

### 间距规范
- 页面内边距：24px（桌面端）/ 16px（移动端）
- 卡片间距：16px
- 组件内间距：遵循Ant Design 8px基础网格

### 响应式设计
- 断点：768px
- 移动端优化：
  - 统计卡片垂直堆叠
  - 表格横向滚动
  - 筛选项换行显示

## 交互设计

### 操作流程
1. **查看列表**
   - 用户进入页面 → 加载脆弱性列表
   - 默认显示所有状态的记录

2. **筛选记录**
   - 输入关键字 → 实时筛选
   - 选择等级/状态 → 点击查询按钮 → 更新列表

3. **处理脆弱性**
   - 点击"处理"按钮 → 打开处理抽屉
   - 填写处理表单 → 点击"提交处理结果"
   - 表单验证 → 提交成功 → 显示成功提示 → 关闭抽屉
   - 列表状态自动更新

4. **查看详情**
   - 点击"查看"按钮 → 打开详情抽屉
   - 查看完整信息（只读模式）

### 反馈机制
- 加载状态：表格显示loading动画
- 成功提示：message.success("处理记录提交成功")
- 错误提示：表单字段下方显示错误信息
- 空状态：表格显示Empty组件

## 与系统一差异分析

### 功能差异
| 特性 | 系统一（管理端） | 系统二（协作端） |
|------|-----------------|-----------------|
| 派发任务 | ✅ 可以派发 | ❌ 不可派发 |
| 处理任务 | ❌ 不处理 | ✅ 处理和反馈 |
| 统计维度 | 多维度（部门/系统/类型） | 单一维度（自己的任务） |
| KPI展示 | 全局统计 | 个人任务统计 |
| 数据范围 | 所有业务系统 | 责任范围内的任务 |

### 页面差异
1. **统计卡片**
   - 系统一：总脆弱性、待处置、高危、未确认资产
   - 系统二：待处理、处理中、本月完成

2. **操作按钮**
   - 系统一：查看详情、派发任务、批量派发
   - 系统二：处理、查看、导出数据

3. **详情展示**
   - 系统一：Modal模态框 + 派发表单
   - 系统二：Drawer抽屉 + 处理表单

## 技术实现

### 文件结构
```
src/pages/collaboration/vulnerability/
├── index.tsx                    # 主页面组件
├── index.css                    # 主页面样式
├── types.ts                     # 类型定义
├── mockData.ts                  # Mock数据
└── components/
    ├── MetricsCards.tsx         # 统计卡片组件
    ├── MetricsCards.css         # 统计卡片样式
    ├── DisposalDrawer.tsx       # 处理抽屉组件
    └── DisposalDrawer.css       # 处理抽屉样式
```

### 依赖库
- React 18
- Ant Design 5.x
- TypeScript
- React Router DOM

### 路由配置
- 路径：`/collaboration/vulnerability`
- 系统：系统二（业务协同管理系统）
- 布局：CollaborationLayout

## 测试要点

### 功能测试
- [ ] 统计卡片数据正确显示
- [ ] 关键字搜索准确筛选
- [ ] 等级和状态筛选正常工作
- [ ] 处理表单验证有效
- [ ] 提交处理结果成功
- [ ] 导出功能正常（待实现）

### UI测试
- [ ] 响应式布局在不同屏幕正常显示
- [ ] 表格横向滚动正常
- [ ] 抽屉动画流畅
- [ ] 按钮hover效果正常

### 兼容性测试
- [ ] Chrome浏览器
- [ ] Firefox浏览器
- [ ] Safari浏览器
- [ ] Edge浏览器

## 待优化项

### 功能扩展
1. 实现真实的API接口对接
2. 添加文件上传后端存储
3. 支持批量处理操作
4. 添加消息通知功能
5. 支持处理记录导出

### 性能优化
1. 大数据量时使用虚拟滚动
2. 添加防抖优化搜索
3. 图片/文件懒加载
4. 缓存已加载的数据

### 用户体验
1. 添加快捷键支持
2. 记住用户筛选偏好
3. 支持自定义列显示
4. 添加操作引导提示

## 更新日志

### v1.0.0 (2025-10-14)
- ✅ 完成页面基础框架
- ✅ 实现统计卡片展示
- ✅ 实现脆弱性列表
- ✅ 实现筛选功能
- ✅ 实现处理抽屉
- ✅ 完成Mock数据
- ✅ 集成到路由系统
