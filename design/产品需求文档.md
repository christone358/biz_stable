# 上海市大数据中心业务健康总览页 - 产品需求文档 (PRD)

## 版本信息
- **文档版本**：v2.0
- **创建日期**：2024年
- **最后更新**：2024年
- **文档状态**：需求评审中
- **产品经理**：[姓名]
- **技术负责人**：[姓名]

---

## 1. 项目概述

### 1.1 项目背景
上海市大数据中心需要建立一个以业务为视角的保障平台，通过整合基础的IT视角资源，让业务人员和管理者能够直观观测业务的安全状态和运维状态。当前面临的问题：
- 各系统数据孤立，缺乏统一的业务视角
- 重要业务系统的健康状态无法及时掌握
- 安全风险和运维问题定位困难
- 缺乏支持决策的数据分析工具

### 1.2 产品定位
本产品是上海市大数据中心业务保障系统的核心仪表板，采用矩阵图作为核心可视化手段，为保障团队、管理层及相关委办单位提供以业务视角为核心的全市政务信息系统健康与安全状态全景视图。

### 1.3 设计目标
- **全局态势感知**：一览全市政务信息系统整体健康与安全态势
- **优先级识别**：通过矩阵分析，快速识别需要优先关注的重要业务系统
- **问题定位**：支持快速定位存在健康问题或安全风险的业务系统及其责任部门
- **数据驱动决策**：基于业务重要性、资产规模和健康状态的多维数据分析，支持资源分配决策

### 1.4 成功指标
- 系统健康状态识别时间从30分钟缩短到5分钟
- 重要业务系统故障响应时间从2小时缩短到30分钟
- 高危漏洞处理效率提升50%
- 用户满意度达到90%以上

## 2. 用户分析

### 2.1 目标用户
1. **市大数据中心领导及管理人员**
   - 关注整体业务健康度、SLA达成情况及重大风险分布
   - 需要快速了解全局态势，支持决策

2. **各委办单位信息化负责人**
   - 关注本单位所属业务系统的状态及在全局中的位置
   - 需要监控本部门系统健康状况

3. **业务保障团队（运维与安全）**
   - 需要快速识别并处理高优先级故障或安全漏洞的一线人员
   - 关注具体的技术指标和告警信息

### 2.2 用户场景
#### 场景一：中心领导视角
- 打开页面，默认查看全局态势
- 扫视矩阵图，快速定位到右上角（高重要性）的红色/黄色气泡
- 点击对应气泡查看系统详情，或查看下方列表获取详细信息

#### 场景二：委办局负责人视角
- 在左侧树中点击本单位名称
- 查看矩阵图中本单位的系统分布情况，了解本单位系统的重要性分布和健康状态
- 查看下方列表，了解需要优先处理的系统

#### 场景三：保障团队视角
- 关注矩阵图中最大的红色/黄色气泡（重要且有问题的大系统）
- 结合"未修复高危漏洞"指标和实时告警列表，确定处理优先级
- 使用表格的排序和筛选功能，快速定位到需要处理的系统

## 3. 功能需求

### 3.1 左侧导航栏：组织业务树

#### 3.1.1 基本功能
- **展示方式**：横向可滚动的树形结构，展示上海市政务信息系统的组织架构
- **默认状态**：页面加载时默认选中"市大数据中心"根节点，展示全局数据

#### 3.1.2 数据结构层级
```
市大数据中心 (156)
├── 市公安局 (23)
├── 市民政局 (12)
├── 市市场监管局 (18)
├── 市教委 (15)
├── 市卫生健康委 (21)
├── 市交通委 (19)
├── 市住建委 (14)
├── 市应急局 (8)
├── 市财政局 (11)
├── 市人社局 (15)
└── 其他委办单位...
```

#### 3.1.3 节点展示规范

**节点显示内容**：
- 组织名称：最多显示8个中文字符，超出显示省略号
- 系统数量：格式为"(数字)"，如"(23)"
- 健康状态指示器：8px圆形色块

**健康状态指示器规则**：
- 🟢 绿色：该组织下所有系统均为健康状态
- 🟡 黄色：该组织下存在警告状态系统，但无故障系统
- 🔴 红色：该组织下存在故障状态系统
- ⚫ 灰色：该组织下存在状态未知的系统，或暂无系统数据

#### 3.1.4 交互行为

**点击交互**：
- 点击任意节点，右侧内容区域立即更新
- 显示加载状态：0.5秒内完成数据刷新
- 当前选中节点高亮显示（蓝色背景色）
- 面包屑导航更新显示当前路径

**滚动交互**：
- 支持横向鼠标滚动和触摸滑动
- 滚动条样式：半透明，悬停时显示
- 边界反馈：到达边界时有轻微弹性效果

**悬停交互**：
- 悬停时节点背景色变浅
- 显示系统详细信息工具提示

#### 3.1.5 异常状态处理

**数据加载失败**：
- 显示"数据加载失败，点击重试"提示
- 提供重试按钮
- 保留上次成功加载的数据

**无组织数据**：
- 显示"暂无组织数据"占位符
- 显示刷新按钮

**网络连接异常**：
- 显示离线状态指示器
- 数据变灰显示，禁用交互

### 3.2 顶部全局指标卡

#### 3.2.1 指标卡布局
- **排列方式**：水平排列，4个指标卡等宽显示
- **响应式**：屏幕宽度不足时，调整为2行2列布局

#### 3.2.2 具体指标定义

**指标卡1：总业务系统**
- 主要数值：当前选中组织下的业务系统总数
- 显示格式：大号数字 + "个系统"
- 辅助信息：相比上月变化，如"+3个新接入"
- 颜色：中性蓝色 (#1677FF)

**指标卡2：异常系统**
- 主要数值：警告+故障状态的系统数量
- 显示格式：大号数字 + "异常系统"
- 辅助信息：
  - 子项：警告X个、故障Y个
  - 占比：异常率百分比，如"异常率 12.5%"
- 颜色规则：
  - 异常率 < 5%：绿色 (#52C41A)
  - 5% ≤ 异常率 < 15%：橙色 (#FAAD14)
  - 异常率 ≥ 15%：红色 (#FF4D4F)

**指标卡3：未处理紧急告警**
- 主要数值：P0和P1级别的未确认告警总数
- 显示格式：大号数字 + "紧急告警"
- 辅助信息：
  - 子项：P0级 X个、P1级 Y个
  - 最新告警时间：如"最新 3分钟前"
- 颜色：红色 (#FF4D4F)
- 特殊效果：数量>0时，数字闪烁提醒

**指标卡4：未修复高危漏洞**
- 主要数值：CVE评分≥8.0的未修复漏洞数量
- 显示格式：大号数字 + "高危漏洞"
- 辅助信息：
  - 影响系统数：如"影响 5个系统"
  - 最长未修复时间：如"最长未修复 15天"
- 颜色：深红色 (#A8071A)
- 特殊样式：红色边框，内置警告图标

#### 3.2.3 数据更新规则
- **更新频率**：每30秒自动刷新一次
- **更新动画**：数值变化时显示计数动画
- **时间戳**：卡片右下角显示"最后更新时间"

#### 3.2.4 交互行为
- **点击行为**：点击指标卡跳转到对应的详细页面
- **悬停效果**：卡片阴影加深，显示更多详细信息
- **数据钻取**：支持点击查看历史趋势图（弹窗显示）

#### 3.2.5 异常状态处理

**数据获取失败**：
- 主要数值显示"--"
- 辅助信息显示"数据获取失败"
- 卡片变灰，提供重试按钮

**部分数据缺失**：
- 能获取的数据正常显示
- 缺失的子项显示"--"
- 显示小标提示"部分数据异常"

**历史数据对比异常**：
- 当数值异常波动（如>50%变化）时
- 显示橙色感叹号图标
- 悬停提示："数据波动较大，请确认"

### 3.3 业务健康状态矩阵图

#### 3.3.1 基本结构
- **图表类型**：D3.js实现的散点图/气泡图矩阵
- **画布尺寸**：宽度自适应容器，高度固定600px
- **边距设置**：上下左右各预留80px用于坐标轴和标签

#### 3.3.2 坐标轴定义

**X轴（委办单位）**：
- 数据来源：当前选中组织下的所有委办单位
- 显示方式：等距分布，单位名称倾斜45°显示
- 标签格式：最多显示6个汉字，超出省略号
- 排序规则：按系统数量降序排列

**Y轴（业务重要性等级）**：
- 分级定义：
  - 极高：影响全市核心业务运行的关键系统
  - 高：影响重要业务功能的核心系统
  - 中：影响一般业务功能的重要系统
  - 低：影响辅助功能的一般系统
- 显示方式：4个等距刻度，从下到上递增
- 标签位置：Y轴左侧显示

#### 3.3.3 气泡可视化编码

**气泡位置**：
- X坐标：根据所属委办局确定
- Y坐标：根据业务重要性等级确定
- 同位置多系统：采用随机偏移避免重叠

**气泡大小**：
- 数据映射：资产数量（服务器、网络设备、应用实例等）
- 尺寸范围：半径8px-40px
- 计算公式：radius = 8 + (assetCount / maxAssetCount) * 32
- 边界情况：资产数量为0时，半径固定为8px

**气泡颜色**：
- 🟢 健康(#52C41A)：系统运行正常，无告警
- 🟡 警告(#FAAD14)：系统存在轻微问题，有低级别告警
- 🔴 故障(#FF4D4F)：系统存在严重问题，有高级别告警
- ⚫ 未知(#BFBFBF)：系统状态数据缺失或获取失败

**气泡标签**：
- 显示条件：气泡半径≥20px时始终显示，其他悬停显示
- 标签内容：业务系统名称，最多显示10个字符
- 标签位置：气泡正下方，避免与其他元素重叠
- 字体样式：12px，半透明白底黑字

#### 3.3.4 交互功能

**悬停交互**：
- 气泡效果：半径增加20%，边框高亮
- 工具提示内容：
  ```
  系统名称：上海市民生活服务平台
  归属单位：市民政局
  重要性等级：极高
  健康状态：警告
  资产数量：156个
  错误率：2.3%
  响应时间：245ms
  最新告警：3分钟前 - 数据库连接异常
  ```
- 显示位置：鼠标位置右上角，边界自适应

**点击交互**：
- 单击：跳转到系统详情页面
- 双击：在当前页面弹窗显示系统概览信息
- 选中状态：气泡添加蓝色边框，持续显示工具提示

**缩放和平移**：
- 鼠标滚轮：支持缩放，范围0.5x-3x
- 拖拽：支持画布平移
- 重置按钮：恢复到默认视图

#### 3.3.5 图例和筛选

**健康状态图例**：
- 位置：矩阵图右下角
- 内容：4种状态的色块和说明
- 交互：点击可过滤显示对应状态的系统

**重要性筛选器**：
- 位置：矩阵图右上角
- 形式：4个复选框
- 默认：全部选中
- 行为：取消勾选隐藏对应等级的系统

#### 3.3.6 数据边界情况

**无系统数据**：
- 显示：空白矩阵图，中央显示"暂无系统数据"
- 操作：提供刷新按钮

**单一委办单位**：
- X轴显示：该单位居中显示
- 布局调整：气泡在垂直方向上适当分散

**数据量过大（>200个系统）**：
- 性能优化：采用Canvas渲染替代SVG
- 显示策略：优先显示重要性高的系统
- 提示信息：显示"数据较多，已优化显示"

**系统状态频繁变化**：
- 更新策略：批量更新，避免频繁重绘
- 动画效果：状态变化时添加颜色过渡动画

### 3.4 核心业务系统状态列表

#### 3.4.1 表格基本结构
- **显示区域**：固定高度400px，支持垂直滚动
- **分页方式**：虚拟滚动，支持大量数据展示
- **默认显示**：前50条记录，按重要性和状态排序

#### 3.4.2 表格列定义

**列1：系统名称（宽度：25%）**
- 显示内容：业务系统完整名称
- 字符限制：最多显示30个字符，超出显示省略号
- 交互行为：点击系统名称跳转到详情页面
- 样式：蓝色链接，悬停加下划线

**列2：归属单位（宽度：15%）**
- 显示内容：系统所属的委办局名称
- 字符限制：最多显示12个字符，超出省略号
- 筛选功能：支持下拉筛选，显示所有可用单位
- 样式：普通文本，灰色字体

**列3：健康状态（宽度：12%）**
- 显示方式：状态标签 + 文字描述
- 状态标签样式：
  - 🟢 健康：绿色圆形图标 + "正常"文字
  - 🟡 警告：黄色三角图标 + "警告"文字
  - 🔴 故障：红色圆形图标 + "故障"文字
  - ⚫ 未知：灰色圆形图标 + "未知"文字
- 排序：故障 > 警告 > 未知 > 健康

**列4：高危漏洞数（宽度：12%）**
- 显示格式：数字 + "个"，如"3个"
- 数值为0：显示"无"，绿色字体
- 数值>0：显示具体数字，红色字体
- 点击交互：弹窗显示漏洞详细列表
- 排序：按数字降序

**列5：关键业务指标（宽度：20%）**
- 显示内容：
  - 错误率：格式"错误率 X.XX%"
  - 响应时间：格式"响应时间 XXXms"
- 颜色规则：
  - 错误率 < 1%：绿色
  - 错误率 1%-5%：橙色
  - 错误率 > 5%：红色
- 响应时间规则：
  - < 200ms：绿色
  - 200ms-1000ms：橙色
  - > 1000ms：红色

**列6：未处理告警（宽度：10%）**
- 显示格式：数字 + "条"，如"5条"
- 数值为0：显示"无"，绿色字体
- 数值>0：按优先级显示颜色
  - P0/P1级告警：红色字体，闪烁效果
  - P2/P3级告警：橙色字体
- 点击交互：弹窗显示告警详细列表

**列7：操作（宽度：6%）**
- 按钮内容："详情"
- 样式：蓝色文字按钮
- 点击行为：跳转到系统详情页面

#### 3.4.3 表格行为

**默认排序规则**：
1. 优先级：有P0/P1告警的系统
2. 健康状态：故障 > 警告 > 未知 > 健康
3. 重要性等级：极高 > 高 > 中 > 低
4. 高危漏洞数：降序
5. 系统名称：拼音排序

**筛选功能**：
- 归属单位：下拉多选，支持搜索
- 健康状态：4个复选框
- 重要性等级：4个复选框
- 有高危漏洞：单选框"仅显示有高危漏洞的系统"
- 有未处理告警：单选框"仅显示有未处理告警的系统"

**搜索功能**：
- 位置：表格上方右侧
- 搜索范围：系统名称、归属单位
- 搜索方式：模糊匹配，支持拼音搜索
- 实时搜索：输入后500ms自动搜索

#### 3.4.4 特殊行样式

**高危漏洞系统行**：
- 背景色：浅红色 (#FFF2F0)
- 左边框：3px红色边框
- 漏洞数字段：添加警告图标

**P0/P1告警系统行**：
- 背景色：浅橙色 (#FFF7E6)
- 告警数字段：红色字体，每2秒闪烁一次

**离线/未知状态系统行**：
- 整行变灰，透明度70%
- 鼠标悬停显示"系统状态未知"提示

#### 3.4.5 分页和加载

**虚拟滚动**：
- 一屏显示约15行
- 滚动时动态加载数据
- 支持快速跳转到顶部/底部

**加载状态**：
- 初始加载：显示骨架屏动画
- 滚动加载：底部显示"加载中..."
- 无更多数据：显示"已显示全部数据"

#### 3.4.6 数据异常处理

**无系统数据**：
- 显示：空状态图标 + "暂无系统数据"
- 操作：提供"刷新"按钮

**筛选无结果**：
- 显示：搜索图标 + "暂无符合条件的系统"
- 操作：显示"清空筛选条件"按钮

**部分数据缺失**：
- 缺失字段显示"--"
- 行背景添加虚线边框
- 悬停提示："部分数据缺失"

**数据更新失败**：
- 保留上次成功的数据
- 表格顶部显示黄色提示条："数据更新失败，显示历史数据"
- 提供重试按钮

### 3.5 实时告警与漏洞摘要

#### 3.5.1 显示位置和布局
- **位置**：页面右侧固定区域，宽度280px
- **高度**：与主内容区域同高，内部可滚动
- **背景**：半透明白色背景，轻微阴影效果

#### 3.5.2 数据内容定义

**告警信息格式**：
```
[HH:MM] [告警-P0] 上海市民生服务平台：数据库连接失败
[HH:MM] [告警-P1] 市公安局执法系统：CPU使用率超过90%
[HH:MM] [告警-P2] 市教委学籍系统：磁盘空间不足
```

**漏洞信息格式**：
```
[HH:MM] [漏洞-高危] 市民政局救助系统：发现SQL注入漏洞(CVE-2024-1234)
[HH:MM] [漏洞-中危] 市财政局预算系统：发现XSS漏洞(CVE-2024-5678)
```

#### 3.5.3 优先级和筛选规则

**显示优先级**（从高到低）：
1. P0级系统告警（红色，闪烁显示）
2. 高危安全漏洞（深红色）
3. P1级系统告警（橙红色）
4. 中危安全漏洞（橙色）
5. P2级系统告警（黄色）

**时间窗口**：显示最近24小时内的记录

**数量限制**：最多显示100条记录，超出时自动移除最早的记录

#### 3.5.4 视觉设计规范

**时间戳格式**：
- 显示格式：HH:MM（24小时制）
- 颜色：灰色 (#8C8C8C)
- 字体：等宽字体，便于对齐

**类型标签样式**：
- [告警-P0]：白色文字，红色背景，闪烁效果
- [告警-P1]：白色文字，橙红色背景
- [告警-P2]：白色文字，橙色背景
- [漏洞-高危]：白色文字，深红色背景
- [漏洞-中危]：白色文字，橙色背景

**系统名称样式**：
- 字体：粗体
- 颜色：深蓝色 (#1677FF)
- 点击：跳转到系统详情页面

#### 3.5.5 交互行为

**滚动行为**：
- 自动滚动：新记录出现时自动滚动到顶部
- 手动滚动：用户滚动后停止自动滚动
- 恢复自动滚动：5分钟无操作后恢复自动滚动

**点击交互**：
- 点击整条记录：弹窗显示详细信息
- 点击系统名称：跳转系统详情页
- 点击时间：显示完整时间戳

**悬停效果**：
- 整条记录背景变浅
- 显示"点击查看详情"提示

#### 3.5.6 数据更新机制

**实时推送**：
- 通过WebSocket接收实时数据
- 新数据到达时在顶部插入新记录
- 插入动画：从顶部滑入效果

**离线处理**：
- 网络断开时显示"连接已断开"提示
- 重连后自动同步离线期间的数据
- 同步时显示"正在同步离线数据"提示

**数据去重**：
- 相同系统、相同类型、5分钟内的重复告警合并显示
- 合并格式：在描述后添加"(x3)"表示重复次数

#### 3.5.7 异常状态处理

**无数据状态**：
- 显示：云朵图标 + "暂无告警信息"
- 说明："系统运行良好"
- 颜色：浅灰色

**数据加载失败**：
- 显示：警告图标 + "数据加载失败"
- 操作：提供重试按钮
- 保留：显示上次成功的数据（变灰）

**WebSocket连接异常**：
- 状态指示：顶部显示红色连接状态条
- 文字：" 连接已断开，正在重连..."
- 重连成功：绿色提示条显示2秒后消失

#### 3.5.8 详情弹窗规范

**告警详情弹窗内容**：
```
告警详情
────────────────
告警时间：2024-01-15 14:30:25
告警级别：P1 - 高优先级
所属系统：上海市民生服务平台
归属单位：市民政局
告警类型：系统异常
告警内容：数据库连接池耗尽，当前连接数95/100
影响范围：全部用户无法访问
持续时间：3分钟
处理状态：未处理
处理建议：立即重启应用服务，检查数据库连接配置
```

**漏洞详情弹窗内容**：
```
安全漏洞详情
────────────────
发现时间：2024-01-15 14:30:25
漏洞等级：高危 (CVSS: 8.5)
CVE编号：CVE-2024-1234
所属系统：市公安局执法系统
归属单位：市公安局
漏洞类型：SQL注入
漏洞描述：用户输入未经过滤，存在SQL注入风险
影响范围：登录模块
修复状态：未修复
修复建议：升级到安全版本v2.1.3
紧急程度：建议24小时内修复
```

## 4. 非功能性需求

### 4.1 性能要求
- 页面首次加载时间 < 3秒
- 矩阵图交互响应时间 < 500ms
- 支持同时展示1000+业务系统
- 实时数据更新间隔：30秒

### 4.2 兼容性要求
- 支持主流浏览器：Chrome 80+、Firefox 75+、Safari 13+、Edge 80+
- 响应式设计，支持1920x1080及以上分辨率
- 支持触摸设备操作

### 4.3 安全要求
- 基于角色的权限控制
- 数据传输加密（HTTPS）
- 审计日志记录
- 敏感信息脱敏展示

### 4.4 可用性要求
- 系统可用性达到99.9%
- 支持7x24小时运行
- 故障恢复时间 < 1小时

## 5. 数据需求

### 5.1 核心数据模型

#### 5.1.1 业务系统基础信息
```json
{
  "systemId": "SYS_SH_CIVIL_001",
  "systemName": "上海市民生活服务平台",
  "displayName": "市民生活服务平台",
  "description": "为市民提供一站式生活服务的综合平台",
  "department": {
    "id": "DEPT_CIVIL",
    "name": "市民政局",
    "fullName": "上海市民政局"
  },
  "importance": "CRITICAL", // CRITICAL, HIGH, MEDIUM, LOW
  "businessType": "PUBLIC_SERVICE", // 业务类型
  "serviceCategory": "CITIZEN_SERVICE", // 服务分类
  "onlineDate": "2023-06-15",
  "contacts": {
    "systemOwner": "张三",
    "technicalContact": "李四",
    "businessContact": "王五"
  },
  "sla": {
    "availability": 99.9,
    "responseTime": 200,
    "errorRate": 0.01
  }
}
```

#### 5.1.2 系统健康状态数据
```json
{
  "systemId": "SYS_SH_CIVIL_001",
  "timestamp": "2024-01-15T14:30:25Z",
  "status": "WARNING", // HEALTHY, WARNING, CRITICAL, UNKNOWN
  "metrics": {
    "availability": 99.85,
    "errorRate": 2.3,
    "avgResponseTime": 245,
    "throughput": 1520,
    "activeUsers": 8430
  },
  "infrastructure": {
    "cpuUsage": 68.5,
    "memoryUsage": 74.2,
    "diskUsage": 45.8,
    "networkLatency": 12.3
  },
  "assetCount": {
    "servers": 12,
    "databases": 3,
    "applications": 8,
    "networkDevices": 6,
    "total": 29
  },
  "lastCheck": "2024-01-15T14:30:00Z",
  "dataSource": "APM_SYSTEM"
}
```

#### 5.1.3 告警数据结构
```json
{
  "alertId": "ALT_20240115_001234",
  "systemId": "SYS_SH_CIVIL_001",
  "timestamp": "2024-01-15T14:30:25Z",
  "level": "P1", // P0, P1, P2, P3, P4
  "category": "SYSTEM", // SYSTEM, SECURITY, BUSINESS, NETWORK
  "type": "DATABASE_CONNECTION_FAILED",
  "title": "数据库连接失败",
  "description": "主数据库连接池耗尽，当前连接数95/100",
  "impact": "HIGH", // HIGH, MEDIUM, LOW
  "affectedUsers": 8430,
  "duration": 180, // 秒
  "status": "OPEN", // OPEN, ACKNOWLEDGED, RESOLVED, CLOSED
  "source": "ZABBIX",
  "tags": ["database", "connection", "critical"],
  "assignee": null,
  "resolvedAt": null,
  "acknowledgedAt": null
}
```

#### 5.1.4 安全漏洞数据结构
```json
{
  "vulnerabilityId": "VUL_20240115_5678",
  "cveId": "CVE-2024-1234",
  "systemId": "SYS_SH_CIVIL_001",
  "discoveryDate": "2024-01-15T09:15:30Z",
  "severity": "HIGH", // CRITICAL, HIGH, MEDIUM, LOW, INFO
  "cvssScore": 8.5,
  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "title": "SQL注入漏洞",
  "description": "用户输入未经过滤，存在SQL注入风险",
  "category": "INJECTION", // INJECTION, XSS, CSRF, etc.
  "affectedComponent": "用户登录模块",
  "exploitability": "HIGH",
  "impact": "数据泄露风险",
  "status": "OPEN", // OPEN, FIXING, TESTING, RESOLVED, FALSE_POSITIVE
  "assignee": "安全团队",
  "fixRecommendation": "升级到安全版本v2.1.3",
  "estimatedFixTime": 24, // 小时
  "source": "NESSUS_SCAN",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1234"
  ]
}
```

### 5.2 数据更新频率和策略

#### 5.2.1 实时数据（WebSocket推送）
- **告警数据**：立即推送
- **系统状态变化**：状态变更时推送
- **漏洞新增**：发现后立即推送

#### 5.2.2 定时更新数据（HTTP API轮询）
- **基础信息**：每天凌晨2点更新
- **健康状态指标**：每30秒更新
- **漏洞扫描结果**：每4小时更新
- **资产信息**：每小时更新

#### 5.2.3 缓存策略
- **静态数据**（组织架构、系统基本信息）：本地缓存24小时
- **动态数据**（健康状态、告警）：本地缓存1分钟
- **历史数据**：浏览器缓存7天

### 5.3 数据质量要求

#### 5.3.1 数据完整性
- 必填字段完整率 > 95%
- 系统基础信息完整率 100%
- 健康状态数据及时性 > 98%

#### 5.3.2 数据准确性
- 系统状态判断准确率 > 99%
- 告警误报率 < 5%
- 漏洞扫描准确率 > 95%

#### 5.3.3 数据一致性
- 多数据源数据一致性检查
- 状态变更时间差 < 30秒
- 关联数据同步误差 < 1分钟

### 5.4 数据源集成

#### 5.4.1 监控系统数据源
- **Zabbix**：系统基础监控指标
- **Prometheus + Grafana**：应用性能监控
- **ELK Stack**：日志分析和告警
- **APM系统**：应用性能管理

#### 5.4.2 安全系统数据源
- **Nessus**：漏洞扫描
- **SIEM系统**：安全事件管理
- **WAF日志**：Web应用防火墙
- **漏洞库**：CVE/CNVD数据库

#### 5.4.3 CMDB系统数据源
- **资产管理系统**：IT资产信息
- **ITSM系统**：服务管理数据
- **组织架构系统**：部门和人员信息
- **业务系统注册表**：系统基础信息

## 6. 接口需求

### 6.1 RESTful API接口规范

#### 6.1.1 组织架构接口
```
GET /api/v1/organizations
功能：获取组织架构树
参数：无
响应：{
  "code": 200,
  "message": "success",
  "data": {
    "organizations": [
      {
        "id": "ROOT",
        "name": "市大数据中心",
        "systemCount": 156,
        "healthStatus": "WARNING",
        "children": [...]
      }
    ]
  },
  "timestamp": "2024-01-15T14:30:25Z"
}
```

#### 6.1.2 系统状态查询接口
```
GET /api/v1/organizations/{orgId}/systems
功能：获取指定组织下的业务系统列表
参数：
- orgId: 组织ID（必需）
- page: 页码（可选，默认1）
- pageSize: 页面大小（可选，默认50）
- status: 过滤状态（可选）
- importance: 重要性过滤（可选）
- search: 搜索关键词（可选）

响应：{
  "code": 200,
  "message": "success",
  "data": {
    "systems": [...],
    "pagination": {
      "total": 23,
      "page": 1,
      "pageSize": 50,
      "totalPages": 1
    }
  },
  "timestamp": "2024-01-15T14:30:25Z"
}
```

#### 6.1.3 矩阵数据接口
```
GET /api/v1/organizations/{orgId}/matrix
功能：获取矩阵图显示数据
参数：
- orgId: 组织ID（必需）
- importance: 重要性过滤（可选，多值）
- status: 状态过滤（可选，多值）

响应：{
  "code": 200,
  "message": "success",
  "data": {
    "systems": [...],
    "dimensions": {
      "departments": ["市公安局", "市民政局", ...],
      "importanceLevels": ["CRITICAL", "HIGH", "MEDIUM", "LOW"]
    },
    "statistics": {
      "totalSystems": 23,
      "healthyCount": 18,
      "warningCount": 4,
      "criticalCount": 1
    }
  },
  "timestamp": "2024-01-15T14:30:25Z"
}
```

#### 6.1.4 KPI指标接口
```
GET /api/v1/organizations/{orgId}/kpi
功能：获取KPI指标数据
参数：
- orgId: 组织ID（必需）

响应：{
  "code": 200,
  "message": "success",
  "data": {
    "totalSystems": 23,
    "abnormalSystems": {
      "count": 5,
      "warningCount": 4,
      "criticalCount": 1,
      "rate": 0.217
    },
    "urgentAlerts": {
      "total": 8,
      "p0Count": 2,
      "p1Count": 6,
      "latestTime": "2024-01-15T14:25:30Z"
    },
    "criticalVulnerabilities": {
      "count": 3,
      "affectedSystems": 2,
      "longestUnfixed": 15
    }
  },
  "timestamp": "2024-01-15T14:30:25Z"
}
```

#### 6.1.5 告警列表接口
```
GET /api/v1/alerts/recent
功能：获取最近告警列表
参数：
- hours: 时间范围（可选，默认24）
- level: 告警级别过滤（可选）
- limit: 限制数量（可选，默认100）

响应：{
  "code": 200,
  "message": "success",
  "data": {
    "alerts": [...],
    "hasMore": false
  },
  "timestamp": "2024-01-15T14:30:25Z"
}
```

### 6.2 WebSocket实时接口

#### 6.2.1 连接端点
```
WebSocket URL: wss://api.domain.com/ws/dashboard
认证：Bearer Token in query parameter
```

#### 6.2.2 消息格式
```json
{
  "type": "ALERT_NEW", // 消息类型
  "timestamp": "2024-01-15T14:30:25Z",
  "data": {
    "alertId": "ALT_20240115_001234",
    "systemId": "SYS_SH_CIVIL_001",
    "level": "P1",
    "title": "数据库连接失败",
    "description": "主数据库连接池耗尽"
  }
}
```

#### 6.2.3 消息类型定义
- **ALERT_NEW**：新告警
- **ALERT_RESOLVED**：告警解决
- **SYSTEM_STATUS_CHANGED**：系统状态变更
- **VULNERABILITY_NEW**：新漏洞发现
- **CONNECTION_STATUS**：连接状态变更

### 6.3 错误处理规范

#### 6.3.1 HTTP状态码
- **200**：请求成功
- **400**：请求参数错误
- **401**：认证失败
- **403**：权限不足
- **404**：资源不存在
- **429**：请求频率超限
- **500**：服务器内部错误
- **503**：服务暂不可用

#### 6.3.2 错误响应格式
```json
{
  "code": 400,
  "message": "请求参数错误",
  "errors": [
    {
      "field": "orgId",
      "message": "组织ID不能为空"
    }
  ],
  "timestamp": "2024-01-15T14:30:25Z",
  "requestId": "req_1234567890"
}
```

### 6.4 性能要求
- **响应时间**：API接口响应时间 < 500ms
- **并发支持**：支持1000并发用户
- **WebSocket连接**：支持500个同时连接
- **数据更新**：实时数据推送延迟 < 1秒

## 7. 验收标准

### 7.1 功能验收标准

#### 7.1.1 组织树导航功能
- ✅ **必须**：页面加载时默认选中根节点，显示全局数据
- ✅ **必须**：点击任意组织节点，右侧内容立即更新（<0.5秒）
- ✅ **必须**：正确显示每个组织的系统数量和健康状态指示器
- ✅ **必须**：支持横向滚动，所有委办局节点均可访问
- ✅ **必须**：当前选中路径高亮显示
- ✅ **应该**：悬停时显示系统详细信息工具提示
- ⚠️  **处理**：数据加载失败时显示重试选项

#### 7.1.2 KPI指标卡功能
- ✅ **必须**：4个指标卡正确显示当前组织的聚合数据
- ✅ **必须**：异常系统数量准确统计（警告+故障状态）
- ✅ **必须**：未处理紧急告警数量实时更新
- ✅ **必须**：高危漏洞数量及影响系统数准确显示
- ✅ **必须**：数值变化时显示计数动画
- ✅ **必须**：点击指标卡能跳转到对应详细页面
- ⚠️  **处理**：数据异常波动时显示警告提示

#### 7.1.3 矩阵图可视化功能
- ✅ **必须**：气泡正确按委办单位和重要性等级定位
- ✅ **必须**：气泡大小正确反映资产数量规模
- ✅ **必须**：气泡颜色正确反映健康状态
- ✅ **必须**：悬停时显示完整的系统详细信息
- ✅ **必须**：点击气泡能跳转到系统详情页面
- ✅ **必须**：图例筛选功能正常工作
- ✅ **必须**：支持缩放和平移操作
- ✅ **应该**：同位置多系统时避免重叠
- ⚠️  **处理**：数据量>200个系统时性能优化生效

#### 7.1.4 系统状态列表功能
- ✅ **必须**：7个列字段内容准确显示
- ✅ **必须**：默认排序规则正确执行
- ✅ **必须**：筛选功能正常工作（单位、状态、重要性等）
- ✅ **必须**：搜索功能支持系统名称和单位名称模糊匹配
- ✅ **必须**：高危漏洞系统行有视觉突出效果
- ✅ **必须**：P0/P1告警系统行闪烁提醒
- ✅ **必须**：虚拟滚动支持大数据量展示
- ✅ **应该**：点击列标题支持排序
- ⚠️  **处理**：无数据时显示空状态

#### 7.1.5 实时告警摘要功能
- ✅ **必须**：最近24小时告警和漏洞信息正确显示
- ✅ **必须**：优先级排序正确（P0>高危漏洞>P1>中危漏洞>P2）
- ✅ **必须**：WebSocket实时推送功能正常
- ✅ **必须**：新告警自动滚动到顶部
- ✅ **必须**：点击告警弹窗显示详细信息
- ✅ **必须**：相同告警5分钟内合并显示
- ⚠️  **处理**：网络断开时显示连接状态提示

### 7.2 性能验收标准

#### 7.2.1 响应时间要求
- ✅ **必须**：页面首次加载时间 < 3秒
- ✅ **必须**：组织切换响应时间 < 0.5秒
- ✅ **必须**：矩阵图交互响应时间 < 200ms
- ✅ **必须**：列表筛选响应时间 < 300ms
- ✅ **必须**：API接口响应时间 < 500ms

#### 7.2.2 并发性能要求
- ✅ **必须**：支持100个并发用户正常使用
- ✅ **必须**：WebSocket支持50个同时连接
- ✅ **应该**：支持1000个系统数据展示
- ✅ **应该**：矩阵图支持200个气泡流畅交互

#### 7.2.3 数据更新性能
- ✅ **必须**：实时数据推送延迟 < 1秒
- ✅ **必须**：KPI指标30秒内更新
- ✅ **必须**：系统状态数据30秒内更新

### 7.3 用户体验验收标准

#### 7.3.1 界面设计要求
- ✅ **必须**：界面美观，符合政府系统设计规范
- ✅ **必须**：色彩搭配符合无障碍设计标准
- ✅ **必须**：字体大小和对比度适合长时间使用
- ✅ **必须**：图标和按钮含义清晰直观
- ✅ **必须**：信息层次分明，重点突出

#### 7.3.2 交互体验要求
- ✅ **必须**：所有交互操作有即时视觉反馈
- ✅ **必须**：悬停效果一致且自然
- ✅ **必须**：加载状态有清晰指示
- ✅ **必须**：错误信息友好且有解决建议
- ✅ **应该**：动画效果流畅不卡顿

#### 7.3.3 响应式设计要求
- ✅ **必须**：1920px分辨率下完整显示
- ✅ **必须**：1366px分辨率下功能正常
- ✅ **应该**：支持触摸设备操作
- ✅ **应该**：支持键盘导航

### 7.4 技术质量验收标准

#### 7.4.1 代码质量要求
- ✅ **必须**：TypeScript严格模式下无类型错误
- ✅ **必须**：ESLint检查无错误和警告
- ✅ **必须**：单元测试覆盖率 > 80%
- ✅ **必须**：关键业务逻辑测试覆盖率 100%
- ✅ **应该**：代码复用率 > 60%

#### 7.4.2 安全要求
- ✅ **必须**：所有API调用使用HTTPS
- ✅ **必须**：用户输入进行XSS过滤
- ✅ **必须**：敏感信息不在前端暴露
- ✅ **必须**：通过安全扫描工具检测
- ✅ **必须**：符合政府信息安全要求

#### 7.4.3 兼容性要求
- ✅ **必须**：Chrome 80+浏览器正常运行
- ✅ **必须**：Firefox 75+浏览器正常运行
- ✅ **必须**：Safari 13+浏览器正常运行
- ✅ **必须**：Edge 80+浏览器正常运行

### 7.5 数据准确性验收标准

#### 7.5.1 数据一致性要求
- ✅ **必须**：多个组件显示的同一数据保持一致
- ✅ **必须**：实时更新的数据与后台数据一致
- ✅ **必须**：筛选后的统计数据准确
- ✅ **必须**：跨页面的数据关联正确

#### 7.5.2 数据完整性要求
- ✅ **必须**：所有必填字段数据完整展示
- ✅ **必须**：缺失数据有明确标识
- ✅ **必须**：数据更新失败有明确提示
- ⚠️  **处理**：离线状态下数据处理正确

### 7.6 业务逻辑验收标准

#### 7.6.1 健康状态判断逻辑
- ✅ **必须**：系统健康状态判断规则正确
- ✅ **必须**：组织健康状态聚合计算正确
- ✅ **必须**：异常系统统计逻辑准确
- ✅ **必须**：告警级别映射正确

#### 7.6.2 安全风险评估逻辑
- ✅ **必须**：高危漏洞识别准确
- ✅ **必须**：漏洞影响范围计算正确
- ✅ **必须**：安全告警优先级排序正确
- ✅ **必须**：修复时间估算合理

### 7.7 验收测试用例

#### 7.7.1 基础功能测试用例
1. 页面加载测试：验证页面在3秒内完成加载
2. 组织切换测试：验证点击不同组织节点数据正确更新
3. 矩阵图交互测试：验证悬停和点击功能正常
4. 列表筛选测试：验证各种筛选条件组合正确工作
5. 实时更新测试：验证WebSocket推送数据正确显示

#### 7.7.2 异常情况测试用例
1. 网络断开测试：验证离线状态提示和恢复机制
2. 数据错误测试：验证错误数据的显示和处理
3. 大数据量测试：验证系统在大数据量下的性能表现
4. 并发访问测试：验证多用户同时访问的稳定性
5. 浏览器兼容性测试：验证各主流浏览器功能正常

#### 7.7.3 用户场景测试用例
1. 领导查看全局态势场景测试
2. 委办局负责人监控本单位系统场景测试
3. 运维人员处理紧急告警场景测试
4. 安全人员跟踪漏洞修复场景测试
5. 移动设备访问场景测试（如适用）

### 验收通过标准

- **必须项**：100%通过，0个未修复问题
- **应该项**：≥90%通过，重要问题全部修复
- **处理项**：100%有处理方案，用户体验良好
- **性能指标**：100%达标
- **安全要求**：100%满足
- **测试用例**：通过率≥95%

只有满足以上所有标准，产品才能通过最终验收并投入使用。

## 8. 项目里程碑

1. **需求确认阶段**（1周）：确认产品需求和设计方案
2. **设计阶段**（2周）：完成UI/UX设计和技术架构设计
3. **开发阶段**（6周）：前端开发、后端接口开发、数据集成
4. **测试阶段**（2周）：功能测试、性能测试、安全测试
5. **部署上线**（1周）：生产环境部署、用户培训

## 9. 风险评估

### 9.1 技术风险
- 大数据量的矩阵图渲染性能风险
- 实时数据更新的系统负载风险
- 多数据源集成的数据一致性风险

### 9.2 业务风险
- 用户需求变更风险
- 数据源变化导致的接口变更风险
- 安全合规要求变化风险

### 9.3 缓解措施
- 采用虚拟化渲染技术优化性能
- 建立完善的数据质量监控机制
- 设计灵活的架构支持需求变更